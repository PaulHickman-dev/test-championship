!function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,(function(t){return e[t]}).bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="dqSs")}({dqSs:function(e,t,r){"use strict";function s(e){return"function"==typeof e}r.r(t);let n=!1;const i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){n=e},get useDeprecatedSynchronousErrorHandling(){return n}};function o(e){setTimeout(()=>{throw e})}const c={closed:!0,next(e){},error(e){if(i.useDeprecatedSynchronousErrorHandling)throw e;o(e)},complete(){}},a=Array.isArray||(e=>e&&"number"==typeof e.length);function u(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}u.prototype=Object.create(Error.prototype);const l=u;let h=(()=>{class e{constructor(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}unsubscribe(){let e,t=!1;if(this.closed)return;let{_parent:r,_parents:n,_unsubscribe:i,_subscriptions:o}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let c=-1,u=n?n.length:0;for(;r;)r.remove(this),r=++c<u&&n[c]||null;if(s(i))try{i.call(this)}catch(f){t=!0,e=f instanceof l?p(f.errors):[f]}if(a(o))for(c=-1,u=o.length;++c<u;){const r=o[c];if(null!==(h=r)&&"object"==typeof h)try{r.unsubscribe()}catch(f){t=!0,e=e||[],f instanceof l?e=e.concat(p(f.errors)):e.push(f)}}var h;if(t)throw new l(e)}add(t){let r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){const t=r;(r=new e)._subscriptions=[t]}break;default:if(!t)return e.EMPTY;throw new Error("unrecognized teardown "+t+" added to Subscription.")}if(r._addParent(this)){const e=this._subscriptions;e?e.push(r):this._subscriptions=[r]}return r}remove(e){const t=this._subscriptions;if(t){const r=t.indexOf(e);-1!==r&&t.splice(r,1)}}_addParent(e){let{_parent:t,_parents:r}=this;return t!==e&&(t?r?-1===r.indexOf(e)&&(r.push(e),!0):(this._parents=[e],!0):(this._parent=e,!0))}}return e.EMPTY=function(e){return e.closed=!0,e}(new e),e})();function p(e){return e.reduce((e,t)=>e.concat(t instanceof l?t.errors:t),[])}const f="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class d extends h{constructor(e,t,r){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=c;break;case 1:if(!e){this.destination=c;break}if("object"==typeof e){e instanceof d?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new b(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new b(this,e,t,r)}}[f](){return this}static create(e,t,r){const s=new d(e,t,r);return s.syncErrorThrowable=!1,s}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:e,_parents:t}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this}}class b extends d{constructor(e,t,r,n){let i;super(),this._parentSubscriber=e;let o=this;s(t)?i=t:t&&(i=t.next,r=t.error,n=t.complete,t!==c&&(s((o=Object.create(t)).unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=i,this._error=r,this._complete=n}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;i.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:r}=i;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):o(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;o(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);i.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),i.useDeprecatedSynchronousErrorHandling)throw r;o(r)}}__tryOrSetError(e,t,r){if(!i.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(s){return i.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=s,e.syncErrorThrown=!0,!0):(o(s),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const m="function"==typeof Symbol&&Symbol.observable||"@@observable";let y=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const r=new e;return r.source=this,r.operator=t,r}subscribe(e,t,r){const{operator:s}=this,n=function(e,t,r){if(e){if(e instanceof d)return e;if(e[f])return e[f]()}return e||t||r?new d(e,t,r):new d(c)}(e,t,r);if(n.add(s?s.call(n,this.source):this.source||i.useDeprecatedSynchronousErrorHandling&&!n.syncErrorThrowable?this._subscribe(n):this._trySubscribe(n)),i.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n}_trySubscribe(e){try{return this._subscribe(e)}catch(t){i.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:r,isStopped:s}=e;if(t||s)return!1;e=r&&r instanceof d?r:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=w(t))((t,r)=>{let s;s=this.subscribe(t=>{try{e(t)}catch(n){r(n),s&&s.unsubscribe()}},r,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[m](){return this}pipe(...e){return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)}:function(){})(this);var t}toPromise(e){return new(e=w(e))((e,t)=>{let r;this.subscribe(e=>r=e,e=>t(e),()=>e(r))})}}return e.create=t=>new e(t),e})();function w(e){if(e||(e=i.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function _(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new g(e,t))}}class g{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new v(e,this.project,this.thisArg))}}class v extends d{constructor(e,t,r){super(e),this.project=t,this.count=0,this.thisArg=r||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(t)}}const E=new y(e=>e.complete());function S(e){return e?function(e){return new y(t=>e.schedule(()=>t.complete()))}(e):E}const x=e=>t=>{for(let r=0,s=e.length;r<s&&!t.closed;r++)t.next(e[r]);t.closed||t.complete()};function T(e,t){return new y(t?r=>{const s=new h;let n=0;return s.add(t.schedule(function(){n!==e.length?(r.next(e[n++]),r.closed||s.add(this.schedule())):r.complete()})),s}:x(e))}let O=(()=>{class e{constructor(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}}accept(e,t,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,r)}toObservable(){switch(this.kind){case"N":return function(...e){let t=e[e.length-1];var r;switch((r=t)&&"function"==typeof r.schedule?e.pop():t=void 0,e.length){case 0:return S(t);case 1:return t?T(e,t):function(e){const t=new y(t=>{t.next(e),t.complete()});return t._isScalar=!0,t.value=e,t}(e[0]);default:return T(e,t)}}(this.value);case"E":return e=this.error,new y(t=>t.error(e));case"C":return S()}var e;throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}static createError(t){return new e("E",void 0,t)}static createComplete(){return e.completeNotification}}return e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e})();class j{call(e,t){return t.subscribe(new M(e))}}class M extends d{constructor(e){super(e)}_next(e){e.observe(this.destination)}}class P{call(e,t){return t.subscribe(new D(e))}}class D extends d{constructor(e){super(e)}_next(e){this.destination.next(O.createNext(e))}_error(e){const t=this.destination;t.next(O.createError(e)),t.complete()}_complete(){const e=this.destination;e.next(O.createComplete()),e.complete()}}class k{constructor(e,t,r,s,n,i,o){this.teams=e,this.penaltiesEffective=t,this.penalisedTies=r,this.unpenalisedTies=s,this.count=n,this.status=i,this.run=o}}class N{constructor(){this.points=0,this.series=0}value(){return 100*this.points+this.series}}r.d(t,"ResultsWorker",function(){return L});class H extends Array{Max(e){return this.reduce((t,r)=>e(t)>e(r)?t:r)}}let L=(()=>{return function(e,t,r,s){var n,i=arguments.length,o=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(i<3?n(o):i>3?n(t,r,o):n(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}([e=>{!function(e){const t=function e(t,r,n,i){return s(n)&&(i=n,n=void 0),i?e(t,r,n).pipe(_(e=>a(e)?i(...e):i(e))):new y(e=>{!function e(t,r,s,n,i){let o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){const e=t;t.addEventListener(r,s,i),o=()=>e.removeEventListener(r,s,i)}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){const e=t;t.on(r,s),o=()=>e.off(r,s)}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){const e=t;t.addListener(r,s),o=()=>e.removeListener(r,s)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let o=0,c=t.length;o<c;o++)e(t[o],r,s,n,i)}n.add(o)}(t,r,function(t){e.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},e,n)})}(self,"message").pipe(_(e=>e.data),_(e=>new O(e.kind,e.value,e.error)),function(e){return e.lift(new j)},_(e=>e.payload)),r=new e;r.work(t).pipe(_(e=>{const t={payload:e};return function(e){return!!e.selectTransferables}(r)&&(t.transferables=r.selectTransferables(e)),t}),function(e){return e.lift(new P)}).subscribe(e=>{postMessage(e,e.hasValue?e.value.transferables:void 0)})}(e)}],class{work(e){return e.pipe(_(e=>this.RunChampionship(e)))}RunChampionship(e){this.log=!1,this.report(JSON.stringify(e,null,1));let{unpenalised:t,penalised:r}=this.initialise(e),s=0,n=0,i=0;for(let c=0;c<e.shard;c++){this.clear(e,t,r);for(let s=0;s<e.teams.length;s++)for(let n=0;n<e.teams.length;n++)this.runSeries(e,t,r,s,n);let o,c;({out:o,ties:s}=this.getWinners(r,e,s,!0)),({out:c,ties:n}=this.getWinners(t,e,n,!1)),o.sort().join(",")!==c.sort().join(",")&&i++,this.log=!1}var o=new k(e.teams,i,s,n,e.count,"complete",e.run);return this.report(JSON.stringify(o,null,1)),o}initialise(e){let t=new H,r=new H;for(let s=0;s<e.teams.length;s++)e.teams[s].penalisedWins=e.teams[s].unpenalisedWins=e.teams[s].penalties=0,t.push(new N),r.push(new N);return{unpenalised:r,penalised:t}}clear(e,t,r){for(let s=0;s<e.teams.length;s++)t[s].points=r[s].points=0,t[s].series=r[s].series=0}report(e){this.log&&console.log(e)}runSeries(e,t,r,s,n){let i=e.teams[s].matches[n];if(0===i||null==i)return;let o=e.seriesPoints[i]/i,c=e.scalePenalties?.05*o:2,a=0,u=0;this.report(e.teams[s].name+" vs "+e.teams[n].name+" - "+i.toString()+" matches");for(let l=0;l<i;l++){let i=Math.random();i>=1-e.probabilities.draw/100?(r[s].points+=o/3,r[n].points+=o/3,t[s].points+=o/3,t[n].points+=o/3,e.teams[s].matchDraws++,e.teams[n].matchDraws++,this.report("  draw")):i>=1-e.probabilities.draw/100-e.probabilities.tie/100?(r[s].points+=o/2,r[n].points+=o/2,t[s].points+=o/2,t[n].points+=o/2,e.teams[s].matchTies++,e.teams[n].matchTies++,this.report("  tie")):i>=(1-e.probabilities.draw/100-e.probabilities.tie/100)*e.probabilities.away/100?(r[n].points+=o,t[n].points+=o,e.teams[s].matchLoss++,e.teams[n].matchWins++,u++,this.report("  "+e.teams[n].name+" win")):(r[s].points+=o,t[s].points+=o,e.teams[n].matchLoss++,e.teams[s].matchWins++,a++,this.report("  "+e.teams[s].name+" win"));let l=Math.random(),h=Math.random();for(let t=0;t<10;t++)h<e.probabilities.penalty[t]/100&&(r[n].points-=c,e.teams[n].penalties+=c,this.report("  "+e.teams[n].name+" slow over penalty")),l<e.probabilities.penalty[t]/100&&(r[s].points-=c,e.teams[s].penalties+=c,this.report("  "+e.teams[s].name+" slow over penalty"))}a>u?(r[s].series++,t[s].series++,e.teams[n].seriesLoss++,e.teams[s].seriesWins++):u>a?(r[n].series++,t[n].series++,e.teams[s].seriesLoss++,e.teams[n].seriesWins++):(e.teams[s].seriesDraws++,e.teams[n].seriesDraws++),this.report("  Result: "+e.teams[s].name+" "+a.toString()+"-"+u.toString()+" "+e.teams[n].name)}getWinners(e,t,r,s){let n=new H,i=new H;if(this.log){console.log((s?"":"un")+"penalised standings:");for(let r=0;r<t.teams.length;r++)console.log("  "+t.teams[r].name+" "+e[r].points+" points, "+e[r].series+" series, value = "+e[r].value())}let o=e.Max(e=>e.value()).value(),c=0;for(let a=0;a<t.teams.length;a++)e[a].value()==o&&(c++,n.push(a),i.push(a));if(c>2)for(r++;c>2;){let e=Math.floor(Math.random()*c);n.splice(e,1),c--}if(c<2){let s=e.Max(e=>e.value()==o?-1e4:e.value()).value(),c=0;for(let r=0;r<t.teams.length;r++)e[r].value()==s&&(c++,n.push(r),i.push(r));if(c>1)for(r++;c>1;){let e=1+Math.floor(Math.random()*c);n.splice(e,1),c--}}for(let a of n)s?t.teams[a].penalisedWins++:t.teams[a].unpenalisedWins++;return{out:i,ties:r}}})})()}});